---
title: Jenkins控制台中文乱码
date: 2018-02-06 18:32:00 +0800
categories: [自动化, Jenkins]
# Ref
# - https://blog.csdn.net/u010727765/article/details/131313026
# - https://asd1054.github.io/2019/06/27/VSCODE-Python-%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81-%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9Cmd%E7%BC%96%E7%A0%81%E8%A7%A3%E5%86%B3/
---

### 设置环境变量 - 系统变量

`JAVA_TOOL_OPTIONS` 

`-Dfile.encoding=UTF8`

![image-20230612111846771](https://raw.githubusercontent.com/Rootjhon/img_note/empty/202306121118357.png)

### 设置Jenkins

#### 环境变量

> [http://localhost:8080/manage/configure](http://localhost:8080/manage/configure)

`LANG`

`zh.CH.UTF-8`

![image-20230612112001924](https://raw.githubusercontent.com/Rootjhon/img_note/empty/202306121120137.png)

#### Jenkins.xml

`Difile.encoding=utf-8`

![image-20230612112151558](https://raw.githubusercontent.com/Rootjhon/img_note/empty/202306121121282.png)

### 重启Jenkins

> [http://localhost:8080/restart](http://localhost:8080/restart)



### 控制台编码格式和文件格式不一致



```python
sys.getdefaultencoding()    #系统编码          ===>  utf-8
sys.getfilesystemencoding() #文件编码          ===>  utf-8
sys.stdin.encoding          #控制台输入流编码   ===>  gbk
sys.stdout.encoding         #控制台输出流编码   ===>  gbk
sys.stderr.encoding         #控制台错误流编码   ===>  gbk
```



无论我们的日志是什么编码，都将按照gbk来输出，然后jenkins这边会以utf-8来解析，所以出现乱码



```python
import io
import sys
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')
sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding='utf-8')
```

